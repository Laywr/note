## 微服务架构性能调优篇

单点登录:在分布式系统中,不同的模块在不同的服务器上,就比如商品首页和商品详情是在两台服务器上,当你输入账号密码登录之后,所有的服务器都要收到你这个登录的请求

## NACOS

### 健康检查

- 临时节点,通过节点向注册中心定时发送心跳检测是否正常,心跳中包含一些ip地址,端口号,服务名之类的,5秒上报,15秒标记不健康,30秒剔除
- 永久节点:注册中心向节点探活,发现节点有问题会标记不可用

### 数据模型

三级分类,四层隔离

## Sentinel

流量控制算法

1.计数器固定窗口算法

特点:在固定的时间周期内累加访问次数,当访问次数超过设置的阈值,执行限流策略

缺点:临界问题,在两个间隔的时间周期内,访问次数可能会超过阈值,但是不会触发限流策略

2.计数器滑动窗口算法

特点:将时间周期分为若干个小格,就比如一分钟分成六个小格,每过一个小格的时间,就往右滑动一格

缺点:除了需要记录每个时间周期内的请求次数外,还需要额外记录每个请求到达的时间,比较占内存

3.漏桶算法

特点:将请求放到一个漏桶中,让请求以一个固定的速率从桶里漏出来,如果桶满了,其他请求就会被丢弃

缺点:流出流量的速度是恒定的,对于突发流量来说,即使服务器还有大量空闲资源,只要桶满了,请求就会被丢弃

4.令牌桶算法

特点:将token以r的速率往桶中放,请求过来要先从桶中拿到一个token才可以执行,如果桶中没有token,请求就被丢弃

## 消息队列

消息队列:在消息的传输过程中保存消息的容器,生产者和消费者不直接通讯,依靠队列保证消息的可靠性,避免系统间的相互影响